# Pytorch augmnetations

GPU augmentations realization using pytorch.

There you can find benchmark results.

## Table of contents

- [GPU faster then CPU including transfer](#gpu-faster-then-cpu-including-transfer)
    - [Faster: Pixel level](#faster-pixel-level1)
    - [Faster: Spatial](#faster-spatial1)
- [GPU faster then CPU without transfer](#gpu-faster-then-cpu-without-transfer)
    - [Faster: Pixel level](#faster-pixel-level2)
    - [Faster: Spatial](#faster-spatial2)
- [Pixel level](#pixel-level)
- [Spatial](#spatial)

## GPU faster then CPU including transfer

There you can find links to transforms that is faster then CPU implementations
including time to move tensor to device.

### Faster: Pixel level

- [ISONoise](#isonoise)
- [Normalize](#normalize)

### Faster: Spatial


## GPU faster then CPU without transfer

There you can find links to transforms that is faster then CPU implementations
without time to move tensor to device.

### Faster: Pixel level

- [ISONoise](#isonoise)
- [Normalize](#normalize)
- [RGBShift](#rgbshift)
- [RandomBrightnessContrast](#randombrightnesscontrast)
- [RandomGamma](#randomgamma)

### Faster: Spatial

- [HorizontalFlip](#horizontalflip)
- [LongestMaxSize](#longestmaxsize)
- [PadIfNeeded](#padifneeded)
- [RandomRotate90](#randomrotate90)
- [RandomScale](#randomscale)
- [RandomSizedCrop](#randomsizedcrop)
- [Resize](#resize)
- [SmallestMaxSize](#smallestmaxsize)

## Pixel level

### Blur

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   605.42 |                     237.85 |                  641.14 |
|   [512, 512, 3] |  2302.73 |                    1070.88 |                 2339.75 |
|   [256, 256, 3] |  8043.22 |                    2882.23 |                 5596.40 |
|   [128, 128, 3] | 20964.29 |                    4964.82 |                 8363.38 |

### ChannelDropout

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1949.91 |                     318.70 |                 7200.65 |
|   [512, 512, 3] |  7436.05 |                    1865.30 |                11000.01 |
|   [256, 256, 3] | 15528.36 |                    3971.60 |                11434.60 |
|   [128, 128, 3] | 24891.42 |                    6066.97 |                10903.64 |

### ChannelShuffle

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1165.04 |                     351.20 |                 8530.38 |
|   [512, 512, 3] |  4269.45 |                    1980.50 |                15237.05 |
|   [256, 256, 3] | 13812.96 |                    4782.16 |                18531.97 |
|   [128, 128, 3] | 29790.57 |                    7884.64 |                18403.01 |

### CoarseDropout

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  6243.66 |                     303.55 |                 4517.39 |
|   [512, 512, 3] | 12251.51 |                    1347.25 |                 4202.29 |
|   [256, 256, 3] | 13776.43 |                    2522.73 |                 4506.76 |
|   [128, 128, 3] | 21588.85 |                    3236.84 |                 4655.41 |

### Downscale

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  2935.42 |                     342.69 |                 5348.51 |
|   [512, 512, 3] |  7481.28 |                    1880.73 |                10988.48 |
|   [256, 256, 3] | 10828.01 |                    3976.01 |                11357.66 |
|   [128, 128, 3] | 25377.73 |                    6055.30 |                11795.93 |

### FromFloat

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1075.13 |                     304.76 |                 6627.33 |
|   [512, 512, 3] |  6914.33 |                    1774.10 |                16497.42 |
|   [256, 256, 3] | 19765.99 |                    4601.73 |                18312.14 |
|   [128, 128, 3] | 38695.34 |                    7931.05 |                23012.25 |

### GaussianBlur

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1033.53 |                     223.66 |                  579.89 |
|   [512, 512, 3] |  2582.46 |                    1092.24 |                 2259.78 |
|   [256, 256, 3] |  8248.50 |                    2901.03 |                 6068.10 |
|   [128, 128, 3] | 16616.30 |                    5224.82 |                 9421.61 |

### HueSaturationValue

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  294.07 |                     167.17 |                  309.68 |
|   [512, 512, 3] |  884.26 |                     608.99 |                  859.42 |
|   [256, 256, 3] | 1768.10 |                     795.55 |                  952.28 |
|   [128, 128, 3] | 4995.85 |                     854.02 |                  951.35 |

### ISONoise

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |    7.01 |                     193.19 |                  423.83 |
|   [512, 512, 3] |   28.16 |                     698.15 |                 1064.06 |
|   [256, 256, 3] |  104.09 |                     898.58 |                  980.27 |
|   [128, 128, 3] |  391.25 |                     982.08 |                 1039.69 |

### InvertImg

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  6605.62 |                     319.02 |                10521.53 |
|   [512, 512, 3] | 21056.80 |                    1986.59 |                20060.76 |
|   [256, 256, 3] | 38917.95 |                    4856.91 |                22520.36 |
|   [128, 128, 3] | 65185.63 |                    8996.69 |                28271.89 |

### MedianBlur

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   27.07 |                      14.85 |                   15.92 |
|   [512, 512, 3] |  109.57 |                      60.16 |                   63.58 |
|   [256, 256, 3] |  412.96 |                     232.50 |                  245.18 |
|   [128, 128, 3] | 1504.41 |                     858.00 |                  929.79 |

### MotionBlur

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   604.26 |                     223.11 |                  644.10 |
|   [512, 512, 3] |  2183.74 |                    1074.55 |                 2043.64 |
|   [256, 256, 3] |  6414.17 |                    2426.81 |                 4513.02 |
|   [128, 128, 3] | 13311.11 |                    3876.67 |                 5672.52 |

### Normalize

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  130.46 |                    1020.28 |                 4836.66 |
|   [512, 512, 3] |  541.67 |                    3368.76 |                11508.90 |
|   [256, 256, 3] | 2168.96 |                    5816.50 |                12151.80 |
|   [128, 128, 3] | 7280.89 |                    7413.08 |                12356.21 |

### RGBShift

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  361.98 |                     335.42 |                 3962.16 |
|   [512, 512, 3] | 1241.55 |                    1547.54 |                 6835.23 |
|   [256, 256, 3] | 3280.50 |                    3327.99 |                 7431.37 |
|   [128, 128, 3] | 6841.44 |                    4630.70 |                 7435.11 |

### RandomBrightnessContrast

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  2539.37 |                     339.40 |                 4315.66 |
|   [512, 512, 3] |  4830.64 |                    1832.97 |                13964.72 |
|   [256, 256, 3] |  7278.93 |                    4431.03 |                15875.13 |
|   [128, 128, 3] | 14249.52 |                    7057.22 |                15957.09 |

### RandomGamma

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1880.69 |                     340.21 |                 5574.20 |
|   [512, 512, 3] |  5424.32 |                    1994.74 |                14506.64 |
|   [256, 256, 3] |  7620.20 |                    4804.68 |                22014.92 |
|   [128, 128, 3] | 16150.95 |                    8173.24 |                22090.52 |

### RandomSnow

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   62.02 |                     179.87 |                  400.69 |
|   [512, 512, 3] |  240.43 |                     670.05 |                 1035.70 |
|   [256, 256, 3] |  783.86 |                     914.04 |                 1109.67 |
|   [128, 128, 3] | 2663.23 |                     970.25 |                 1111.15 |

### Solarize

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  2332.37 |                     344.98 |                 4600.48 |
|   [512, 512, 3] |  4331.53 |                    1906.93 |                11856.02 |
|   [256, 256, 3] |  7518.76 |                    4395.91 |                15719.66 |
|   [128, 128, 3] | 15606.25 |                    6899.90 |                15582.19 |

### ToFloat

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   739.18 |                     361.93 |                10305.67 |
|   [512, 512, 3] |  3470.04 |                    2062.32 |                19837.79 |
|   [256, 256, 3] | 11393.76 |                    5038.38 |                28245.61 |
|   [128, 128, 3] | 29035.77 |                    9064.06 |                28211.04 |

### ToGray

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  6776.59 |                     346.57 |                 8767.72 |
|   [512, 512, 3] | 12214.40 |                    2011.38 |                15343.52 |
|   [256, 256, 3] | 23620.97 |                    4625.76 |                19188.00 |
|   [128, 128, 3] | 46963.43 |                    7640.09 |                18594.08 |


## Spatial

### CenterCrop

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 71636.28 |                     330.23 |                52560.20 |
|   [512, 512, 3] | 78091.68 |                    2034.59 |                57361.93 |
|   [256, 256, 3] | 93368.59 |                    5491.00 |                62462.64 |
|   [128, 128, 3] | 94302.76 |                   10065.89 |                63548.13 |

### Crop

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 78781.07 |                     340.19 |                58238.04 |
|   [512, 512, 3] | 83039.08 |                    2158.72 |                58892.22 |
|   [256, 256, 3] | 96580.64 |                    5706.98 |                65377.66 |
|   [128, 128, 3] | 91498.78 |                   11068.46 |                60462.79 |

### CropNonEmptyMaskIfExists

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   91.36 |                     235.72 |                 1166.50 |
|   [512, 512, 3] |  366.19 |                     820.94 |                 1737.79 |
|   [256, 256, 3] | 1349.97 |                    1292.39 |                 1817.91 |
|   [128, 128, 3] | 4014.60 |                    1482.57 |                 1840.84 |

### Flip

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  1129.26 |                     310.23 |                 5289.36 |
|   [512, 512, 3] |  4507.87 |                    1701.73 |                11595.76 |
|   [256, 256, 3] | 12661.02 |                    4387.32 |                16531.49 |
|   [128, 128, 3] | 33413.29 |                    7147.71 |                18017.93 |

### GridDistortion

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  311.44 |                     128.83 |                  243.21 |
|   [512, 512, 3] |  743.41 |                     553.60 |                  956.02 |
|   [256, 256, 3] | 1410.16 |                    1313.97 |                 1882.18 |
|   [128, 128, 3] | 2372.03 |                    1856.96 |                 2276.85 |

### HorizontalFlip

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   880.10 |                     330.43 |                11343.31 |
|   [512, 512, 3] |  3680.67 |                    1846.34 |                22967.39 |
|   [256, 256, 3] | 12993.51 |                    5069.04 |                42953.74 |
|   [128, 128, 3] | 33564.90 |                    9707.96 |                43377.54 |

### LongestMaxSize

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 1349.82 |                     335.39 |                10668.19 |
|   [512, 512, 3] | 2598.91 |                    1718.00 |                 9546.61 |
|   [256, 256, 3] | 3985.34 |                    4012.89 |                11949.38 |
|   [128, 128, 3] | 5364.45 |                    6089.89 |                12464.09 |

### OpticalDistortion

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  410.72 |                     120.17 |                  221.22 |
|   [512, 512, 3] | 1156.63 |                     601.83 |                 1104.58 |
|   [256, 256, 3] | 1997.28 |                    1312.72 |                 3466.21 |
|   [128, 128, 3] | 6098.77 |                    2306.01 |                 6224.44 |

### PadIfNeeded

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 6774.95 |                     339.71 |                 7574.50 |
|   [512, 512, 3] | 2653.16 |                    1814.31 |                 7825.63 |
|   [256, 256, 3] | 3127.13 |                    3016.51 |                 5340.39 |
|   [128, 128, 3] | 4149.37 |                    4089.78 |                 6016.36 |

### RandomCrop

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 57135.32 |                     338.35 |                42452.47 |
|   [512, 512, 3] | 57542.93 |                    2056.33 |                41955.63 |
|   [256, 256, 3] | 85009.91 |                    5323.61 |                59663.78 |
|   [128, 128, 3] | 91732.91 |                   10651.93 |                62170.07 |

### RandomCropNearBBox

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 45570.45 |                     356.16 |                37864.98 |
|   [512, 512, 3] | 47137.60 |                    2061.42 |                37888.93 |
|   [256, 256, 3] | 53472.86 |                    5292.54 |                40603.53 |
|   [128, 128, 3] | 53099.85 |                    9490.66 |                40876.57 |

### RandomGridShuffle

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 1157.71 |                     274.25 |                 1520.72 |
|   [512, 512, 3] | 1681.81 |                     895.62 |                 1506.64 |
|   [256, 256, 3] | 1899.50 |                    1184.15 |                 1539.07 |
|   [128, 128, 3] | 1973.34 |                    1334.02 |                 1534.73 |

### RandomResizedCrop

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  9469.45 |                     343.49 |                15342.96 |
|   [512, 512, 3] |  9588.95 |                    1891.37 |                14376.86 |
|   [256, 256, 3] | 11801.84 |                    4062.82 |                14841.84 |
|   [128, 128, 3] | 16863.15 |                    5924.08 |                13988.52 |

### RandomRotate90

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   304.58 |                     312.63 |                 4850.53 |
|   [512, 512, 3] |  1299.23 |                    1764.17 |                11425.82 |
|   [256, 256, 3] |  4634.42 |                    4353.19 |                16831.35 |
|   [128, 128, 3] | 12609.59 |                    7084.54 |                17011.91 |

### RandomScale

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |   998.80 |                     315.11 |                 6030.98 |
|   [512, 512, 3] |  2419.32 |                    1837.51 |                13648.89 |
|   [256, 256, 3] |  4364.47 |                    4353.89 |                18708.95 |
|   [128, 128, 3] | 13413.45 |                    7114.80 |                18199.07 |

### RandomSizedBBoxSafeCrop

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  183.83 |                     143.33 |                  182.49 |
|   [512, 512, 3] |  216.11 |                     164.76 |                  219.22 |
|   [256, 256, 3] |  205.05 |                     166.05 |                  205.55 |
|   [128, 128, 3] |  249.48 |                     187.39 |                  246.63 |

### RandomSizedCrop

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  9908.58 |                     326.00 |                14330.19 |
|   [512, 512, 3] | 11586.80 |                    1774.44 |                12593.62 |
|   [256, 256, 3] | 13490.37 |                    4100.99 |                15092.74 |
|   [128, 128, 3] | 13607.84 |                    6472.95 |                14972.60 |

### Resize

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  9719.16 |                     324.05 |                18074.22 |
|   [512, 512, 3] |  9719.16 |                    1815.66 |                18359.03 |
|   [256, 256, 3] | 10410.54 |                    4424.07 |                19894.53 |
|   [128, 128, 3] | 12056.79 |                    7669.61 |                21885.91 |

### Rotate

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  589.40 |                      61.06 |                   76.12 |
|   [512, 512, 3] | 1214.36 |                     295.13 |                  369.26 |
|   [256, 256, 3] | 2366.06 |                     708.80 |                  796.27 |
|   [128, 128, 3] | 8169.02 |                     922.33 |                  968.78 |

### ShiftScaleRotate

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  538.54 |                      60.34 |                   77.05 |
|   [512, 512, 3] | 1143.79 |                     291.84 |                  371.71 |
|   [256, 256, 3] | 2266.24 |                     698.32 |                  808.01 |
|   [128, 128, 3] | 7734.70 |                     917.83 |                  988.63 |

### SmallestMaxSize

|          Shapes | CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | ------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] | 1318.59 |                     317.22 |                 9587.42 |
|   [512, 512, 3] | 2074.25 |                    1640.90 |                 8830.49 |
|   [256, 256, 3] | 3397.28 |                    3834.45 |                11765.92 |
|   [128, 128, 3] | 4849.73 |                    6031.32 |                12052.98 |

### Transpose

|          Shapes |   CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | --------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  83953.24 |                     364.74 |                51762.36 |
|   [512, 512, 3] |  86143.03 |                    2188.15 |                53112.63 |
|   [256, 256, 3] | 101815.85 |                    5781.39 |                61219.10 |
|   [128, 128, 3] | 102592.86 |                   11060.96 |                60874.36 |

### VerticalFlip

|          Shapes |  CPU FPS |    GPU with ToTensorV2 FPS | GPU without ToTensorV2 FPS |
| --------------- | -------- | -------------------------- | ----------------------- |
| [1024, 1024, 3] |  7122.63 |                     314.46 |                 4840.01 |
|   [512, 512, 3] | 21231.61 |                    1786.12 |                 9999.77 |
|   [256, 256, 3] | 45242.58 |                    4249.27 |                14407.52 |
|   [128, 128, 3] | 61902.15 |                    6821.90 |                14639.40 |
